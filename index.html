<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pixel Art - Studio Pro</title>
    <!-- Fonts & Icons -->
    <link rel="icon" type="image/png" href="/pixelArt/favicon-96x96.png" sizes="96x96" />
    <!-- Google Fonts - Press Start 2P -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <!-- Custom Font -->
    <style>
        @font-face {
            font-family: 'Inter';
            src: url('fonts/inter-normal.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }

        @font-face {
            font-family: 'Inter';
            src: url('fonts/inter-bold.woff2') format('woff2');
            font-weight: bold;
            font-style: normal;
            font-display: swap;
        }
    </style>
    <!-- CSS for stacked icons -->
    
    <!-- Local Font Awesome Implementation -->
    <link rel="stylesheet" href="fonts/fontawesome-free-6.5.0/css/all.min.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/right-panel.css">
    <link rel="stylesheet" href="css/settings.css">
    <link rel="stylesheet" href="css/modal.css">
    <link rel="stylesheet" href="css/tutorials.css">
    <style>
        .tool-btn.selected {
            background-color: var(--accent-color);
            color: white;
            border-radius: 4px;
        }
    </style>



</head>

<body>

    <!-- HEADER -->
    <header>
        <div class="logo-area">
            <h1>Pixel Art</h1>
            <span class="badge">Studio Pro V1.0</span>
        </div>

        <div class="header-controls">
            <button id="undoBtn" class="btn icon-only" title="Undo (Ctrl+Z)"><i class="fas fa-undo"></i></button>
            <button id="redoBtn" class="btn icon-only" title="Redo (Ctrl+Y)"><i class="fas fa-redo"></i></button>

            <div class="separator" style="height: 20px; width: 1px; margin: 0 10px;"></div>

            <button id="uiBtn" class="btn icon-only" title="Hide UI Elements"> 
                <i class="fa-solid fa-eye"></i>
            </button>

           

            <div class="zoom-controls-header">
                <button id="zoomOutBtn" class="btn icon-only" title="Zoom Out (Ctrl/-)"><i
                        class="fas fa-minus"></i></button>
                <span id="zoomDisplay" class="zoom-display">1x</span>
                <button id="zoomInBtn" class="btn icon-only" title="Zoom In (Ctrl/+)"><i
                        class="fas fa-plus"></i></button>
                <button id="zoomResetBtn" class="btn icon-only" title="Reset Zoom (0)"><i
                        class="fas fa-compress-arrows-alt"></i></button>
            </div>
            <div class="separator" style="height: 20px; width: 1px; margin: 0 10px;"></div>

            <button id="loadProjectBtn" class="btn"><i class="fas fa-folder-open"></i> Load</button>
            <button id="saveProjectBtn" class="btn primary"><i class="fas fa-save"></i> Save</button>
            <button id="saveToBrowserBtn" class="btn"><i class="fas fa-cloud"></i> Save to Browser</button>
            <button id="downloadSheetBtn" class="btn"><i class="fas fa-file-export"></i> Export</button>
        </div>
    </header>


    <!-- MAIN CONTAINER -->
    <div class="main-container">

        <!-- LEFT TOOLBAR -->
        <aside class="toolbar" id="tool-buttons">
            <!-- Drawing Tools Menu -->
            <div class="tool-btn menu-parent" data-tooltip="**Drawing Tools**
Hover to see all available drawing tools">
                <i class="fas fa-pencil-alt"></i>
                <div class="tool-submenu">
                    <div class="tool-btn" data-action="tool" data-type="pencil" data-tooltip="**Pencil Tool**
Draw single pixels"><i class="fas fa-pencil-alt"></i></div>
                    <div class="tool-btn" data-action="tool" data-type="brush" data-tooltip="**Brush Tool**
Draw with soft edges"><i class="fas fa-paint-brush"></i></div>
                    <div class="tool-btn" data-action="tool" data-type="eraser" data-tooltip="**Eraser Tool**
Erase pixels"><i class="fas fa-eraser"></i></div>
                     <div class="tool-btn" data-action="tool" data-type="dither" data-tooltip="**Dither Tool**
dither pixels"><i class="fa-solid fa-chess-board"></i></div>
                </div>
            </div>
            <div class="separator"></div>
            <button class="tool-btn" data-tool="bucket" title="Fill Bucket (F)"><i
                    class="fas fa-fill-drip"></i></button>
            <button class="tool-btn" data-tool="eyedropper" title="Color Picker (I)"><i
                    class="fas fa-eye-dropper"></i></button>
            <div class="separator"></div>
            <!-- Shapes Menu -->
            <div class="tool-btn menu-parent" data-tooltip="**Shapes**
Hover to see all available shapes">
                <i class="fas fa-shapes"></i>
                <div class="tool-submenu">
                    <div class="tool-btn" data-action="tool" data-type="stroke" data-tooltip="**Line Tool**
Draw straight lines"><i class="fas fa-slash"></i></div>
                    <div class="tool-btn" data-action="tool" data-type="rect" data-tooltip="**Rectangle Tool**
Draw rectangles and squares"><i class="far fa-square"></i></div>
                    <div class="tool-btn" data-action="tool" data-type="circle" data-tooltip="**Circle Tool**
Draw circles and ellipses"><i class="far fa-circle"></i></div>
                </div>
            </div>
            <!-- Selection Tool -->
            <button class="tool-btn" id="selectBtn" title="Select ()"><i class="fas fa-mouse-pointer"></i></button>

            <!-- Move Tool -->
            <button class="tool-btn" id="moveBtn" title="Move ()"><i class="fa-solid fa-hand"></i></button>

            <div class="toolbar-spacer"></div>
            <button class="tool-btn" id="layersBtn" title="Layers (L)"><i class="fas fa-layer-group"></i></button>
            <button class="tool-btn" id="tilemapBtn" title="Tilemap"><i class="fas fa-th"></i></button>

            <!-- Settings at bottom like pixel3d-main -->
            <div style="margin-top: auto;"></div>
            <div class="tool-divider"></div>
            <button class="tool-btn" id="keyboardBtn" title="Shortcuts"><i class="fas fa-keyboard"></i></button>
            <button class="tool-btn" id="settingsBtn" title="Settings (S)"><i class="fas fa-cog"></i></button>
        </aside>

        <!-- CENTER WORKSPACE -->
        <div class="workspace">

            <!-- Floating Color History Overlay -->
            <div class="floating-color-history">
                <div class="color-history-swatches">
                    <div class="color-swatch" data-color-index="0" title="Recent Color 1 (Press 1)"></div>
                    <div class="color-swatch" data-color-index="1" title="Recent Color 2 (Press 2)"></div>
                    <div class="color-swatch" data-color-index="2" title="Recent Color 3 (Press 3)"></div>
                    <div class="color-swatch" data-color-index="3" title="Recent Color 4 (Press 4)"></div>
                </div>
            </div>

            <!-- Floating Brush Size Panel -->
            <div class="floating-brush-sizes">
                <div class="brush-size-swatches">
                    <div class="brush-size-swatch" data-brush-size="1" title="Brush Size 1"></div>
                    <div class="brush-size-swatch" data-brush-size="2" title="Brush Size 2"></div>
                    <div class="brush-size-swatch" data-brush-size="3" title="Brush Size 3"></div>
                    <div class="brush-size-swatch" data-brush-size="4" title="Brush Size 4"></div>
                    <div class="brush-size-swatch" data-brush-size="5" title="Brush Size 5"></div>
                </div>
            </div>

            <!-- CANVAS AREA -->
            <div id="canvas-wrapper">
                <div id="drawing-area">
                    <canvas id="layer-composition"></canvas>
                    <canvas id="previewLayer"></canvas>
                    <canvas id="grid-overlay"></canvas>
                    <canvas id="tilemap-overlay"></canvas>
                </div>
                <!-- Zoom Info Overlay -->
                <div class="zoom-overlay">
                    <span id="coords">0, 0</span> | <span id="zoomDisplay">100%</span>
                </div>
            </div>


            <!-- TIMELINE PANEL -->
            <div class="timeline-panel">
                <div class="timeline-controls">
                    <div class="fps-controls">
                        <button id="playBtn" class="btn icon-only"><i class="fas fa-play"></i></button>
                        <button id="stopBtn" class="btn icon-only"><i class="fas fa-stop"></i></button>
                        <button id="onionBtn" class="btn icon-only"><!--<i class="fas fa-onion"></i>-->
                            <i class="fa-solid fa-photo-film"></i></button>

                        <div class="fps-spacer"></div>
                        <label class="fps-label">
                            FPS: <span id="fpsDisplay">12</span>
                            <input type="range" id="fpsSlider" min="1" max="60" value="12" class="fps-slider">
                        </label>
                    </div>
                    <div class="frame-controls">
                        <button id="addFrameBtn" class="btn icon-only" title="Add Frame"><i
                                class="fas fa-plus"></i></button>
                        <button id="duplicateFrameBtn" class="btn icon-only" title="Duplicate"><i
                                class="fas fa-copy"></i></button>
                        <button id="deleteFrameBtn" class="btn icon-only" title="Delete"><i
                                class="fas fa-trash"></i></button>
                    </div>
                </div>
                <div id="frames-list" class="timeline-frames">
                    <!-- Frames injected here -->
                </div>
            </div>

        </div>

        <!-- UNIFIED TABBED PANEL -->
        <div class="dropins-container right">

            <div class="tabs panel-tabs">
                <button class="tab panel-tab active" data-tab="tools" title="Tools" data-content="unified-panel">
                    <i class="fas fa-tools"></i>
                    <span class="tab-name tab-label">Tools</span>
                </button>
                <button class="tab panel-tab" data-tab="layers" title="Layers" data-content="layers-panel">
                    <i class="fas fa-layer-group"></i>
                    <span class="tab-name tab-label">Layers</span>
                </button>

                <button class="tab panel-tab" data-tab="transform" title="Transform" data-content="transform-panel">
                    <i class="fa-solid fa-arrows-up-down-left-right"></i>
                    <span class="tab-name tab-label">Transform</span>
                </button>

                <button class="tab panel-tab" data-tab="effects" title="effects" data-content="effects-panel">
                    <i class="fa-solid fa-hurricane"></i>
                    <span class="tab-name tab-label">Effects</span>
                </button>

                <button class="tab panel-tab" data-tab="tilemap" title="Tilemap" data-content="tilemap-panel">
                    <i class="fas fa-th"></i>
                    <span class="tab-name tab-label">Tilemap</span>
                </button>
            </div>


            <div class="contents right-panel">

                <!-- TOOLS PANEL (SLIDE OUT) -->
                <aside class="content panel-tab-content" data-tab-content="tools" id="unified-panel">
                    <div class="">
                        <div class="panel-section">
                            <!-- Original right panel content goes here -->
                            <div id="panel-preview" class="panel-section">
                                <div class="section-header">
                                    <div class="label-group">
                                        <span>Preview</span>
                                    </div>
                                    <div class="layer-controls">
                                        <button class="section-toggle" data-target="preview-container"
                                            title="Toggle Preview Section">
                                            <i class="fas fa-minus"></i>
                                        </button>

                                    </div>
                                </div>
                                <div class="section-body">
                                    <div id="preview-container">
                                        <canvas id="previewCanvas"></canvas>
                                        <div id="minimap-overlay"></div>
                                    </div>
                                </div>
                            </div>

                            <div id="panel-palette" class="panel-section">
                                <div class="section-header">
                                    <div class="label-group">
                                        <span>Palette</span>
                                    </div>
                                    <div class="layer-controls">
                                        <button class="section-toggle" data-target="palette-container"
                                            title="Toggle Palette Section">
                                            <i class="fas fa-minus"></i>
                                        </button>

                                    </div>
                                </div>
                                <div class="section-body">
                                    <div id="palette-container" class="palette-controls">
                                        <button id="saveColorBtn" title="Save Color" class="palette-control-btn">
                                            <i class="fas fa-save"></i>
                                        </button>
                                        <button id="importPaletteUrlBtn" title="Import Palette"
                                            class="palette-control-btn">
                                            <i class="fas fa-folder-open"></i>
                                        </button>
                                    </div>
                                    <div class="palette-controls">
                                        <input type="color" id="colorPicker" value="#00ff41" class="color-picker-input">
                                        <input type="text" id="colorHex" value="#00ff41" class="color-hex-input">
                                    </div>
                                    <div id="palette-container" class="palette-grid"></div>
                                </div>
                            </div>


                            <div id="panel-tool-options" class="panel-section">
                                <div class="section-header">
                                    <div class="label-group">
                                        <span>Tools Options</span>
                                    </div>
                                    <div class="layer-controls">
                                        <button class="section-toggle" data-target="tools-container"
                                            title="Toggle Tools Section">
                                            <i class="fas fa-minus"></i>
                                        </button>

                                    </div>
                                </div>
                                <div class="section-body">
                                    <div id="tools-container" class="tool-options-control brush-size-control">
                                        <label class="tool-option-label">Brush Size </label>
                                        <div class="slider-value-container">
                                            <div class="slider-container" style="width: 80%;">
                                                <input type="range" id="brushSizeSlider" min="1" max="20" value="1"
                                                    class="tool-option-slider">
                                            </div>
                                            <div class="value-container" style="width: 20%; text-align: right;">
                                                <span id="brushSizeDisplay">1</span>px
                                            </div>
                                        </div>
                                        <div class="preset-brush-sizes">
                                            <button class="preset-brush-size" data-size="1">1</button>
                                            <button class="preset-brush-size" data-size="2">2</button>
                                            <button class="preset-brush-size" data-size="3">3</button>
                                            <button class="preset-brush-size" data-size="4">4</button>
                                            <button class="preset-brush-size" data-size="5">5</button>
                                        </div>
                                    </div>
                                    <div class="tool-options-control opacity-control">
                                        <label class="tool-option-label">Opacity</label>
                                        <div class="slider-value-container">
                                            <div class="slider-container" style="width: 80%;">
                                                <input type="range" id="opacitySlider" min="0" max="100" value="100"
                                                    class="tool-option-slider">
                                            </div>
                                            <div class="value-container" style="width: 20%; text-align: right;">
                                                <span id="opacityDisplay">100</span>%
                                            </div>
                                        </div>
                                    </div>
                                    <div class="tool-options-control blur-control">
                                        <label class="tool-option-label">Brush Blur </label>
                                        <div class="slider-value-container">
                                            <div class="slider-container" style="width: 80%;">
                                                <input type="range" id="blurSlider" min="0" max="10" value="0"
                                                    class="tool-option-slider">
                                            </div>
                                            <div class="value-container" style="width: 20%; text-align: right;">
                                                <span id="blurDisplay">0</span>px
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                </aside>

                <!-- EFFECTS PANEL (SLIDE OUT) -->
                <aside class="content panel-tab-content" data-tab-content="effects" id="effects-panel">
                    <div class="">
                        <div class="panel-section">
                            <div class="section-header">
                                <div class="label-group">
                                    <span>Effects</span>
                                </div>
                                <div class="layer-controls">
                                    <button class="section-toggle" data-target="effects-container"
                                        title="Toggle Effects Section">
                                        <i class="fas fa-minus"></i>
                                    </button>

                                </div>
                            </div>
                            <div class="section-body">
                                <div class="tool-buttons" id="effects-container">
                                    <button class="tool-btn" data-tool="tool" id="mirrorBtn" title="Mirror (X)" data-type="mirror"
                                        data-tooltip="**Mirror Tool**" data-content="mirror-options"><i
                                            class="fas fa-columns"></i>
                                    </button>
                                    <button class="tool-btn" data-tool="dither" id="ditherBtn" title="Dither (D)" data-type="dither"
                                        data-tooltip="**Dither Tool**" data-content="dither-options"><i
                                            class="fas fa-th"></i>
                                    </button>
                                    <button class="tool-btn" data-tool="tool" id="contrastBtn" title="Contrast" data-type="contrast"
                                        data-tooltip="**Contrast Tool** Increase brightness/darkness of pixels"
                                        data-content="contrast-options"><i class="fas fa-sun"></i>
                                    </button>
                                    <button class="tool-btn" data-tool="tool" id="filtersBtn" title="Filters"
                                        data-type="filters" data-tooltip="**Custom Filters**  Invert all colors"
                                        data-content="filters-options"><i class="fas fa-magic"></i>
                                    </button>
                                </div>

                                <div id="mirror-options" class="sub-panel-section">
                                    <div class="section-title">
                                        <span>Mirror Options</span>
                                        <div style="font-size:10px; color:var(--text-secondary); margin-top:4px;">
                                            Choose reflection axis for mirror tool
                                        </div>
                                    </div>

                                    <!-- Visual Mirror Options with Icons -->
                                    <div class="mirror-axis-container">
                                        <!-- No Mirror Option -->
                                        <label class="mirror-axis-option" for="mirrorNone">
                                            <input type="radio" name="mirror-axis" id="mirrorNone" value="none" checked>
                                            <div class="mirror-preview">
                                                <div class="mirror-grid">
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell highlight"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell"></div>
                                                </div>
                                            </div>
                                            <div class="mirror-info">
                                                <div class="mirror-icon"><i class="fas fa-ban"></i></div>
                                                <div class="mirror-text">
                                                    <div class="mirror-title">No Mirror</div>
                                                    <div class="mirror-subtitle">Disabled</div>
                                                </div>
                                            </div>
                                        </label>

                                        <!-- X-Axis Option -->
                                        <label class="mirror-axis-option" for="mirrorX">
                                            <input type="radio" name="mirror-axis" id="mirrorX" value="x">
                                            <div class="mirror-preview">
                                                <div class="mirror-grid">
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell highlight"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell highlight"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell highlight"></div>
                                                    <div class="mirror-cell"></div>
                                                </div>
                                            </div>
                                            <div class="mirror-info">
                                                <div class="mirror-icon"><i class="fas fa-arrows-alt-h"></i></div>
                                                <div class="mirror-text">
                                                    <div class="mirror-title">Horizontal</div>
                                                    <div class="mirror-subtitle">Left ↔ Right</div>
                                                </div>
                                            </div>
                                        </label>

                                        <!-- Y-Axis Option -->
                                        <label class="mirror-axis-option" for="mirrorY">
                                            <input type="radio" name="mirror-axis" id="mirrorY" value="y">
                                            <div class="mirror-preview">
                                                <div class="mirror-grid">
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell highlight"></div>
                                                    <div class="mirror-cell highlight"></div>
                                                    <div class="mirror-cell highlight"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell"></div>
                                                </div>
                                            </div>
                                            <div class="mirror-info">
                                                <div class="mirror-icon"><i class="fas fa-arrows-alt-v"></i></div>
                                                <div class="mirror-text">
                                                    <div class="mirror-title">Vertical</div>
                                                    <div class="mirror-subtitle">Up ↕ Down</div>
                                                </div>
                                            </div>
                                        </label>

                                        <!-- Both Axes Option -->
                                        <label class="mirror-axis-option" for="mirrorBoth">
                                            <input type="radio" name="mirror-axis" id="mirrorBoth" value="both">
                                            <div class="mirror-preview">
                                                <div class="mirror-grid">
                                                    <div class="mirror-cell highlight"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell highlight"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell highlight"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell highlight"></div>
                                                    <div class="mirror-cell"></div>
                                                    <div class="mirror-cell highlight"></div>
                                                </div>
                                            </div>
                                            <div class="mirror-info">
                                                <div class="mirror-icon"><i class="fas fa-expand-arrows-alt"></i></div>
                                                <div class="mirror-text">
                                                    <div class="mirror-title">Both Axes</div>
                                                    <div class="mirror-subtitle">All Directions</div>
                                                </div>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="mirror-note">
                                        <small>
                                            <i class="fas fa-info-circle"></i>
                                            Select mirror axis before using the mirror tool
                                        </small>
                                    </div>
                                </div>

                                <div id="dither-options" class="sub-panel-section">
                                    <div class="section-title">
                                        <span>Dither Options</span>
                                        <div style="font-size:10px; color:var(--text-secondary); margin-top:4px;">
                                            Create custom dither patterns with color blending
                                        </div>
                                    </div>

                                    <!-- Dither Mode Selection -->
                                    <div class="dither-mode-controls">
                                        <label class="dither-label">Dither Mode</label>
                                        <div class="dither-mode-buttons">
                                            <button class="dither-mode-btn" id="ditherDrawMode" data-mode="draw">
                                                <i class="fas fa-pencil-alt"></i> Draw
                                            </button>
                                            <button class="dither-mode-btn" id="ditherFillMode" data-mode="fill">
                                                <i class="fas fa-fill-drip"></i> Fill
                                            </button>
                                        </div>
                                    </div>

                                    <!-- Dither Color Controls -->
                                    <div class="dither-controls">

                                        <div id="dither-tools-container" class="tool-options-control brush-size-control">
                                            <label class="tool-option-label">Dither Brush Size </label>
                                            <div class="slider-value-container">
                                                <div class="slider-container" style="width: 80%;">
                                                    <input type="range" id="ditherbrushSizeSlider" min="1" max="20" value="1"
                                                        class="tool-option-slider">
                                                </div>
                                                <div class="value-container" style="width: 20%; text-align: right;">
                                                    <span id="ditherbrushSizeDisplay">1</span>px
                                                </div>
                                            </div>
                                            <div class="preset-ditherbrush-sizes">
                                                <button class="preset-ditherbrush-size" data-size="1">1</button>
                                                <button class="preset-ditherbrush-size" data-size="2">2</button>
                                                <button class="preset-ditherbrush-size" data-size="3">3</button>
                                                <button class="preset-ditherbrush-size" data-size="4">4</button>
                                                <button class="preset-ditherbrush-size" data-size="5">5</button>
                                            </div>
                                        </div>

                                        <div class="dither-color-row">
                                            <div class="dither-color-control">
                                                <label class="dither-label">Color 1</label>
                                                <div class="color-opacity-container">
                                                    <input type="color" id="ditherColor1" value="#00ff41" class="dither-color-picker">
                                                    <div class="opacity-slider-container">
                                                        <div class="slider-value-container">
                                                            <div class="slider-container" style="width: 80%;">
                                                                <input type="range" id="ditherOpacity1" min="0" max="100" value="100" class="dither-opacity-slider">
                                                            </div>
                                                            <div class="value-container" style="width: 20%; text-align: right;">
                                                                <span id="ditherOpacityValue1">100%</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dither-color-control">
                                                <label class="dither-label">Color 2</label>
                                                <div class="color-opacity-container">
                                                    <input type="color" id="ditherColor2" value="#ffffff" class="dither-color-picker">
                                                    <div class="opacity-slider-container">
                                                        <div class="slider-value-container">
                                                            <div class="slider-container" style="width: 80%;">
                                                                <input type="range" id="ditherOpacity2" min="0" max="100" value="100" class="dither-opacity-slider">
                                                            </div>
                                                            <div class="value-container" style="width: 20%; text-align: right;">
                                                                <span id="ditherOpacityValue2">100%</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Dither Pattern Controls -->
                                        <div class="dither-pattern-controls">
                                            <label class="dither-label">Pattern Style</label>
                                            <div class="pattern-style-container">
                                                <select id="ditherPattern" class="dither-pattern-select">
                                                    <option value="checkerboard">Checkerboard</option>
                                                    <option value="diagonal">Diagonal</option>
                                                    <option value="horizontal">Horizontal Lines</option>
                                                    <option value="vertical">Vertical Lines</option>
                                                    <option value="random">Random Noise</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="dither-pattern-controls">
                                            <label class="dither-label">Pattern Density</label>
                                            <div class="density-slider-container">
                                                <div class="slider-value-container">
                                                    <div class="slider-container" style="width: 80%;">
                                                        <input type="range" id="ditherDensity" min="1" max="10" value="5" class="dither-density-slider">
                                                    </div>
                                                    <div class="value-container" style="width: 20%; text-align: right;">
                                                        <span id="ditherDensityValue">5</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Dither Preview -->
                                        <div class="dither-preview-container">
                                            <label class="dither-label">Preview (<span id="ditherPatternDisplay">Checkerboard</span>)</label>
                                            <div class="dither-preview">
                                                <canvas id="ditherPreviewCanvas" width="64" height="64"></canvas>
                                            </div>
                                        </div>

                                    </div>

                                    <div class="mirror-note">
                                        <small>
                                            <i class="fas fa-info-circle"></i>
                                            Select two colors and adjust opacity, then choose pattern and apply to layer. Only the first colour will be applied if the brush is less than 2 pixels.
                                        </small>
                                    </div>
                                </div>

                                <div id="contrast-options" class="sub-panel-section">
                                    <div class="section-title">
                                        <span>Contrast Options</span>
                                        <div style="font-size:10px; color:var(--text-secondary); margin-top:4px;">
                                            Choose a contrast to apply to a layer
                                        </div>
                                    </div>
                                   

                                    <!-- Brightness/Contrast Slider -->
                                    <div class="tool-options-control brightness-control">
                                        <label class="tool-option-label">Brightness/Contrast</label>
                                        <div class="slider-value-container">
                                            <div class="slider-container" style="width: 80%;">
                                                <input type="range" id="brightnessContrastSlider" min="0.5" max="2.0" value="1.0" step="0.1"
                                                    class="tool-option-slider">
                                            </div>
                                            <div class="value-container" style="width: 20%; text-align: right;">
                                                <span id="brightnessContrastDisplay">1.0</span>x
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Preset Buttons -->
                                    <div class="brightness-presets">
                                        <button class="brightness-preset" data-factor="0.5">Darken</button>
                                        <button class="brightness-preset" data-factor="0.8">Slight Darken</button>
                                        <button class="brightness-preset" data-factor="1.0">Normal</button>
                                        <button class="brightness-preset" data-factor="1.2">Slight Lighten</button>
                                        <button class="brightness-preset" data-factor="2.0">Lighten</button>
                                    </div>

                                    <!-- Apply Button -->
                                    <button id="applyBrightnessContrastBtn" class="btn" style="width: 100%; margin-top: 10px;">
                                        <i class="fas fa-magic"></i> Apply to Selected Layer
                                    </button>

                                    <div class="mirror-note">
                                        <small>
                                            <i class="fas fa-info-circle"></i>
                                            Adjust brightness/contrast and apply to the selected layer
                                        </small>
                                    </div>

                                </div>

                                <div id="filters-options" class="sub-panel-section">
                                    <div class="section-title">
                                        <span>Filter Options</span>
                                        <div style="font-size:10px; color:var(--text-secondary); margin-top:4px;">
                                            Choose a filter to apply to a layer
                                        </div>
                                    </div>
                                    <div id="filters-container">

                                        <!-- Filters will be loaded here -->

                                    </div>
                                    <div class="mirror-note">
                                        <small>
                                            <i class="fas fa-info-circle" ></i>
                                            Select a filter
                                        </small>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </aside>

                <!-- TRANSFORM PANEL (SLIDE OUT) -->
                <aside class="content panel-tab-content" data-tab-content="transform" id="transform-panel">
                    <div class="">
                        <div class="panel-section">
                            <div class="section-header">
                                <div class="label-group">
                                    <span>Transform</span>
                                </div>
                                <div class="layer-controls">
                                    <button class="section-toggle" data-target="transform-container"
                                        title="Toggle Transform Section">
                                        <i class="fas fa-minus"></i>
                                    </button>

                                </div>
                            </div>
                            <div class="section-body">
                                <div class="tool-buttons" id="transform-container">
                                    <button class="tool-btn" id="moveBtn" data-tool="move" data-type="move"
                                        data-tooltip="**Move Tool**" data-content="move-options" title="Move (M)">
                                        <i class="fas fa-arrows-alt"></i>
                                    </button>
                                    <button class="tool-btn" id="rotateBtn" data-tool="rotate" data-type="rotate"
                                        data-tooltip="**Rotate Tool**" data-content="rotate-options"
                                        title="Rotate (L)">
                                        <i class="fas fa-rotate"></i>
                                    </button>
                                    <button class="tool-btn" id="flipBtn" data-tool="flip" data-type="flip"
                                        data-tooltip="**Flip Tool**" data-content="flip-options"
                                        title="Flip Horizontal">
                                        <i class="fa-brands fa-flipboard"></i>
                                    </button>
                                    <button class="tool-btn" id="alignBtn" data-tool="align" data-type="align"
                                        data-tooltip="**Align Tool**" data-content="align-options"
                                        title="Align (S)">
                                        <i class="fa-solid fa-arrows-to-dot"></i>
                                    </button>
                                </div>
                            </div>


                            <div id="move-options" class="sub-panel-section">
                                <div class="section-title">
                                    <span>Move Options</span>
                                    <div style="font-size:10px; color:var(--text-secondary); margin-top:4px;">
                                        Move instructions
                                    </div>
                                </div>

                                <div class="move-container tool-buttons">

                                        <div class="tool-btn" data-action="tool" data-type="select-rect" data-tooltip="**Rectangular Selection**
                                        Draw rectangular selections" data-title="Rectangular selection (R)">
                                            <div class="icon-stack">
                                                <i class="fas fa-mouse-pointer base-icon"></i>
                                                <i class="far fa-square overlay-icon"></i>
                                            </div>
                                         
                                         </div>
                                        <div class="tool-btn" data-action="tool" data-type="select-circle" data-tooltip="**Circular Selection**
                                        Draw circular selections" data-title="Circular selection (C)">
                                            <div class="icon-stack">
                                                <i class="fas fa-mouse-pointer base-icon"></i>
                                                <i class="far fa-circle overlay-icon"></i>
                                            </div>

                                       
                                        </div>
                                        <div class="tool-btn" data-action="tool" data-type="select-lasso" data-tooltip="**Lasso Selection**
                                        Draw freehand selections" data-title="Lasso selection (H)">
                                            <div class="icon-stack">
                                                <i class="fas fa-mouse-pointer base-icon"></i>
                                                <i class="fas fa-draw-polygon overlay-icon"></i>
                                            </div>
                                           
                                        </div>
                                         <div class="tool-btn" data-action="tool" data-type="select-shape" data-tooltip="**Shape Selection**
                                        Click shape for selections" data-title="Shape selection (Z)">
                                            <div class="icon-stack">
                                                <i class="fas fa-mouse-pointer base-icon"></i>
                                                <i class="fa-solid fa-bacterium  overlay-icon"></i>
                                            </div>
                                          
                                        </div>

                                </div>


                                <div  class="mirror-note">
                                    <small>
                                        <i class="fas fa-info-circle" ></i>
                                        <div id="selectnote">
                                           <strong>Selection Tool <span id="title"></span></strong>
                                            <br>Drag the selection to move it. You may switch to other layers and frames.
                                            <br><span class="pill">CMD+C </span> Copy the selected area
                                            <br><span class="pill">CMD+V</span> Paste the copied area
                                            <br><span class="pill">SHIFT</span> Hold to move the content

                                        </div>
                                    </small>
                                </div>

                            </div>

                            <div id="rotate-options" class="sub-panel-section">
                                <div class="section-title">
                                    <span>Rotate Options</span>
                                    <div style="font-size:10px; color:var(--text-secondary); margin-top:4px;">
                                        Rotate instructions
                                    </div>
                                </div>

                                <div class="rotate-container">

                                    <div>
                                     

                                        <div class="rotate-options">
                                            <!-- Clockwise -->
                                            <label class="rotate-btn">
                                                <input type="radio" name="rotate" value="clockwise" checked>
                                                <div class="rotate-icon"><i class="fas fa-undo"></i></div>
                                                <div class="rotate-label">Clockwise 90°</div>
                                                <div class="rotate-description">Rotate content clockwise</div>
                                            </label>

                                            <!-- Counter-Clockwise -->
                                            <label class="rotate-btn">
                                                <input type="radio" name="rotate" value="counter-clockwise">
                                                <div class="rotate-icon"><i class="fas fa-redo"></i></div>
                                                <div class="rotate-label">Counter-Clockwise 90°</div>
                                                <div class="rotate-description">Rotate content counter-clockwise</div>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <div class="mirror-note">
                                    <small>
                                        <i class="fas fa-info-circle"></i>
                                        Select align option before using the align tool
                                    </small>
                                </div>

                            </div>


                            <div id="flip-options" class="sub-panel-section">
                                <div class="section-title">
                                    <span>Flip Options</span>
                                    <div style="font-size:10px; color:var(--text-secondary); margin-top:4px;">
                                        Flip instructions
                                    </div>
                                </div>

                                <!-- Visual Flip Options with Icons -->

                                <div class="flip-axis-container">
                                    <!-- X-Axis Option -->
                                    <label class="mirror-axis-option" for="flipX">
                                        <input type="radio" name="flip-axis" id="flipX" value="x" checked>
                                        <div class="mirror-preview">
                                            <div class="mirror-grid">
                                                <div class="mirror-cell"></div>
                                                <div class="mirror-cell highlight"></div>
                                                <div class="mirror-cell"></div>
                                                <div class="mirror-cell"></div>
                                                <div class="mirror-cell highlight"></div>
                                                <div class="mirror-cell"></div>
                                                <div class="mirror-cell"></div>
                                                <div class="mirror-cell highlight"></div>
                                                <div class="mirror-cell"></div>
                                            </div>
                                        </div>
                                        <div class="mirror-info">
                                            <div class="mirror-icon"><i class="fas fa-arrows-alt-h"></i></div>
                                            <div class="mirror-text">
                                                <div class="mirror-title">Horizontal</div>
                                                <div class="mirror-subtitle">Left ↔ Right</div>
                                            </div>
                                        </div>
                                    </label>

                                    <!-- Y-Axis Option -->
                                    <label class="mirror-axis-option" for="flipY">
                                        <input type="radio" name="flip-axis" id="flipY" value="y">
                                        <div class="mirror-preview">
                                            <div class="mirror-grid">
                                                <div class="mirror-cell"></div>
                                                <div class="mirror-cell"></div>
                                                <div class="mirror-cell"></div>
                                                <div class="mirror-cell highlight"></div>
                                                <div class="mirror-cell highlight"></div>
                                                <div class="mirror-cell highlight"></div>
                                                <div class="mirror-cell"></div>
                                                <div class="mirror-cell"></div>
                                                <div class="mirror-cell"></div>
                                            </div>
                                        </div>
                                        <div class="mirror-info">
                                            <div class="mirror-icon"><i class="fas fa-arrows-alt-v"></i></div>
                                            <div class="mirror-text">
                                                <div class="mirror-title">Vertical</div>
                                                <div class="mirror-subtitle">Up ↕ Down</div>
                                            </div>
                                        </div>
                                    </label>

                                    <!-- Both Axes Option -->
                                    <label class="mirror-axis-option" for="flipBoth">
                                        <input type="radio" name="flip-axis" id="flipBoth" value="both">
                                        <div class="mirror-preview">
                                            <div class="mirror-grid">
                                                <div class="mirror-cell highlight"></div>
                                                <div class="mirror-cell"></div>
                                                <div class="mirror-cell highlight"></div>
                                                <div class="mirror-cell"></div>
                                                <div class="mirror-cell highlight"></div>
                                                <div class="mirror-cell"></div>
                                                <div class="mirror-cell highlight"></div>
                                                <div class="mirror-cell"></div>
                                                <div class="mirror-cell highlight"></div>
                                            </div>
                                        </div>
                                        <div class="mirror-info">
                                            <div class="mirror-icon"><i class="fas fa-expand-arrows-alt"></i></div>
                                            <div class="mirror-text">
                                                <div class="mirror-title">Both Axes</div>
                                                <div class="mirror-subtitle">All Directions</div>
                                            </div>
                                        </div>
                                    </label>
                                </div>
                          

                                <div class="mirror-note">
                                    <small>
                                        <i class="fas fa-info-circle"></i>
                                        Select flip axis before using the flip tool
                                    </small>
                                </div>

                            </div>

                            <div id="align-options" class="sub-panel-section">
                                <div class="section-title">
                                    <span>Align Options</span>
                                    <div style="font-size:10px; color:var(--text-secondary); margin-top:4px;">
                                        Align instructions
                                    </div>
                                </div>

                                <div class="align-container">
                                    <div>

                                        <div class="align-options">
                                            <!-- Top Left -->
                                            <label class="align-btn">
                                                <input type="radio" name="align" value="top-left" checked>
                                                <div class="preview-grid">
                                                    <div class="preview-cell highlight"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                </div>
                                                <div class="align-icon hidden"><i class="fas fa-arrow-up-left"></i></div>
                                                <div class="align-label hidden">Top Left</div>
                                            </label>

                                            <!-- Top Center -->
                                            <label class="align-btn">
                                                <input type="radio" name="align" value="top-center">
                                                <div class="preview-grid">
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell highlight"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                </div>
                                                <div class="align-icon hidden"><i class="fas fa-arrow-up"></i></div>
                                                <div class="align-label hidden">Top</div>
                                            </label>

                                            <!-- Top Right -->
                                            <label class="align-btn">
                                                <input type="radio" name="align" value="top-right">
                                                <div class="preview-grid">
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell highlight"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                </div>
                                                <div class="align-icon hidden"><i class="fas fa-arrow-up-right"></i></div>
                                                <div class="align-label hidden">Top Right</div>
                                            </label>

                                            <!-- Left -->
                                            <label class="align-btn">
                                                <input type="radio" name="align" value="left">
                                                <div class="preview-grid">
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell highlight"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                </div>
                                                <div class="align-icon hidden"><i class="fas fa-arrow-left"></i></div>
                                                <div class="align-label hidden">Left</div>
                                            </label>

                                            <!-- Center -->
                                            <label class="align-btn">
                                                <input type="radio" name="align" value="center">
                                                <div class="preview-grid">
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell highlight"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                </div>
                                                <div class="align-icon hidden"><i class="fas fa-crosshairs"></i></div>
                                                <div class="align-label hidden">Center</div>
                                            </label>

                                            <!-- Right -->
                                            <label class="align-btn">
                                                <input type="radio" name="align" value="right">
                                                <div class="preview-grid">
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell highlight"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                </div>
                                                <div class="align-icon hidden"><i class="fas fa-arrow-right"></i></div>
                                                <div class="align-label hidden">Right</div>
                                            </label>

                                            <!-- Bottom Left -->
                                            <label class="align-btn">
                                                <input type="radio" name="align" value="bottom-left">
                                                <div class="preview-grid">
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell highlight"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                </div>
                                                <div class="align-icon hidden"><i class="fas fa-arrow-down-left"></i></div>
                                                <div class="align-label hidden">Bottom Left</div>
                                            </label>

                                            <!-- Bottom Center -->
                                            <label class="align-btn">
                                                <input type="radio" name="align" value="bottom-center">
                                                <div class="preview-grid">
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell highlight"></div>
                                                    <div class="preview-cell"></div>
                                                </div>
                                                <div class="align-icon hidden"><i class="fas fa-arrow-down"></i></div>
                                                <div class="align-label hidden">Bottom</div>
                                            </label>

                                            <!-- Bottom Right -->
                                            <label class="align-btn">
                                                <input type="radio" name="align" value="bottom-right">
                                                <div class="preview-grid">
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell"></div>
                                                    <div class="preview-cell highlight"></div>
                                                </div>
                                                <div class="align-icon hidden"><i class="fas fa-arrow-down-right"></i></div>
                                                <div class="align-label hidden">Bottom Right</div>
                                            </label>
                                        </div>
                                    </div>

                                </div>



                                <div class="mirror-note">
                                    <small>
                                        <i class="fas fa-info-circle"></i>
                                        Select align option before using the align tool
                                    </small>
                                </div>

                            </div>

                        </div>

                </aside>

                <!-- LAYER PANEL (SLIDE OUT) -->
                <aside class="content panel-tab-content" data-tab-content="layers" id="layers-panel">
                    <div class="">
                        <div class="panel-section">
                            <div class="section-header">
                                <div class="label-group">
                                    <span>Layers</span>
                                </div>
                                <div class="layer-controls">
                                    <button class="section-toggle" data-target="layers-container"
                                        title="Toggle Layers Section">
                                        <i class="fas fa-minus"></i>
                                    </button>

                                </div>
                            </div>

                            <div class="section-body">
                                <div id="layers-container" class="folder-controls">
                                    <button class="folder-btn" id="add-group-btn" title="Add Group">
                                        <i class="fas fa-folder-plus"></i>
                                    </button>
                                    <button class="folder-btn" id="expand-all-btn" title="Expand All">
                                        <i class="fas fa-expand-arrows-alt"></i>
                                    </button>
                                    <button class="folder-btn" id="collapse-all-btn" title="Collapse All">
                                        <i class="fas fa-compress-arrows-alt"></i>
                                    </button>
                                    <button id="addLayerBtn" class="layer-control-btn" title="Add Layer">
                                        <i class="fas fa-plus-circle"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="section-body">
                               
                                <div id="layers-list" class="layers-list">
                                </div>
                            </div>
                        </div>
                    </div>

                </aside>

                <!-- TILEMAP PANEL (SLIDE OUT) -->
                <aside class="content panel-tab-content" data-tab-content="tilemap" id="tilemap-panel">
                   <div class="">
                        <div class="panel-section">
                            <div class="section-header">
                                <div class="label-group">
                                    <span>Tilemap Preview</span>
                                </div>
                                <button class="section-toggle" data-target="tilemap-container"
                                    title="Toggle Tilemap Preview Section">
                                    <i class="fas fa-minus"></i>
                                </button>
                            </div>
                            <div class="section-body">
                                <div id="tilemap-container" class="tilemap-container">
                                    <!-- Original tilemap squares -->
                                    <div class="tilemap-grid" id="tilemapGrid">
                                        <!-- Tilemap squares will be generated here -->
                                    </div>

                                    <!-- Seamless mode toggle and controls -->
                                    <div class="tilemap-controls">
                                        <button id="toggleSeamlessModeBtn" class="btn"
                                            style="width: 100%; margin-bottom: 8px;">
                                            <span id="toggleSeamlessModeText">Enable Seamless Grid</span>
                                        </button>
                                        <button id="clearTilemapBtn" class="btn secondary" style="width: 100%;">Clear
                                            All</button>
                                    </div>

                                    <div class="tilemap-info">
                                        <small
                                            style="color: var(--text-secondary); display: block; margin-top: 8px; text-align: center;">
                                            Click squares to activate tilemap preview<br>
                                            Enable seamless grid to see 3x3 tiling around canvas<br>
                                            Drawing near edges will wrap to opposite side
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </aside>
            </div>




            <!-- Floating Toggle -->
            <div id="panel-toggle" title="Toggle Panel">
                <i class="fas fa-chevron-right"></i>
            </div>

        </div>


        <!-- Keyboard Shortcuts Modal -->
        <div class="modal-overlay" id="keyboard-shortcuts-modal">
            <div class="modal">
                <header>
                    <div class="modal-title">
                        <i class="fas fa-keyboard"></i> Keyboard Shortcuts
                    </div>
                    <div class="modal-subtitle">
                        Quick reference for all available keyboard shortcuts
                    </div>

                    <div class="settings-tabs">
                        <button class="settings-tab active" data-content="shortcuts-tools" id="tab-tools">
                            <i class="fas fa-tools"></i> Tools
                        </button>
                        <button class="settings-tab" data-content="shortcuts-general" id="tab-general">
                            <i class="fas fa-globe"></i> General
                        </button>
                        <button class="settings-tab" data-content="shortcuts-navigation" id="tab-navigation">
                            <i class="fas fa-compass"></i> Navigation
                        </button>
                    </div>
                </header>

                <div class="modal-content-wrapper">

                    <div class="settings-tab-content active" id="shortcuts-tools">
                        <div class="settings-content">
                            <div class="settings-section">
                                <div class="section-heading">Drawing Tools</div>
                                <div class="shortcut-grid">
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">P</div>
                                        <div class="shortcut-description">Pencil Tool</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">B</div>
                                        <div class="shortcut-description">Brush Tool</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">E</div>
                                        <div class="shortcut-description">Eraser Tool</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">F</div>
                                        <div class="shortcut-description">Fill Bucket Tool</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">I</div>
                                        <div class="shortcut-description">Eyedropper Tool</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">L</div>
                                        <div class="shortcut-description">Line Tool</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">R</div>
                                        <div class="shortcut-description">Rectangle Tool</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">C</div>
                                        <div class="shortcut-description">Circle Tool</div>
                                    </div>
                                </div>
                            </div>

                            <div class="settings-section">
                                <div class="section-heading">Selection Tools</div>
                                <div class="shortcut-grid">
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">1</div>
                                        <div class="shortcut-description">Rectangular Selection</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">2</div>
                                        <div class="shortcut-description">Circular Selection</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">3</div>
                                        <div class="shortcut-description">Lasso Selection</div>
                                    </div>
                                </div>
                            </div>

                            <div class="settings-section">
                                <div class="section-heading">Special Tools</div>
                                <div class="shortcut-grid">
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">M</div>
                                        <div class="shortcut-description">Move Tool</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">D</div>
                                        <div class="shortcut-description">Dither Tool</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">X</div>
                                        <div class="shortcut-description">Mirror Tool</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">K</div>
                                        <div class="shortcut-description">Lighten Tool</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">Shift+K</div>
                                        <div class="shortcut-description">Darken Tool</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="settings-tab-content" id="shortcuts-general">
                        <div class="settings-content">
                            <div class="settings-section">
                                <div class="section-heading">File Operations</div>
                                <div class="shortcut-grid">
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">Ctrl+S</div>
                                        <div class="shortcut-description">Save Project</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">Ctrl+O</div>
                                        <div class="shortcut-description">Load Project</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">Ctrl+Z</div>
                                        <div class="shortcut-description">Undo</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">Ctrl+Y</div>
                                        <div class="shortcut-description">Redo</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">Ctrl+C</div>
                                        <div class="shortcut-description">Copy Selection</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">Ctrl+V</div>
                                        <div class="shortcut-description">Paste Selection</div>
                                    </div>
                                </div>
                            </div>

                            <div class="settings-section">
                                <div class="section-heading">View Operations</div>
                                <div class="shortcut-grid">
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">Ctrl+0</div>
                                        <div class="shortcut-description">Reset Zoom</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">Ctrl++</div>
                                        <div class="shortcut-description">Zoom In</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">Ctrl+-</div>
                                        <div class="shortcut-description">Zoom Out</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">Space</div>
                                        <div class="shortcut-description">Play/Stop Animation</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="settings-tab-content" id="shortcuts-navigation">
                        <div class="settings-content">
                            <div class="settings-section">
                                <div class="section-heading">Animation Navigation</div>
                                <div class="shortcut-grid">
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">←</div>
                                        <div class="shortcut-description">Previous Frame</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">→</div>
                                        <div class="shortcut-description">Next Frame</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">Space</div>
                                        <div class="shortcut-description">Play/Stop Animation</div>
                                    </div>
                                </div>
                            </div>

                            <div class="settings-section">
                                <div class="section-heading">Canvas Navigation</div>
                                <div class="shortcut-grid">
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">Mouse Drag</div>
                                        <div class="shortcut-description">Pan Canvas</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">Mouse Wheel</div>
                                        <div class="shortcut-description">Zoom In/Out</div>
                                    </div>
                                    <div class="shortcut-item">
                                        <div class="shortcut-key">Click Minimap</div>
                                        <div class="shortcut-description">Navigate to Area</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <footer>
                    <div class="modal-actions">
                        <button class="btn" id="btn-keyboard-close">Close</button>
                        <button class="btn primary" id="btn-keyboard-print">Print Shortcuts</button>
                    </div>
                </footer>
            </div>

        </div>

        <!-- Settings Shortcuts Modal -->
        <div class="modal-overlay" id="unified-settings-modal">
            <div class="modal">
                <header>
                    <div class="modal-title">
                        <i class="fas fa-cog"></i> Settings
                    </div>
                    <div style="font-size:0.8rem; color:#94a3b8; margin-bottom:15px;">
                        Configure your Pixel Art Studio preferences
                    </div>

                    <div class="settings-tabs">

                        <button class="settings-tab active" data-content="settings-general" id="tab-general">
                            <i class="fas fa-sliders-h"></i> General
                        </button>
                        <button class="settings-tab" data-content="settings-scene" id="tab-scene">
                            <i class="fas fa-image"></i> Art
                        </button>
                        <button class="settings-tab" data-content="settings-export" id="tab-export">
                            <i class="fas fa-download"></i> Export
                        </button>
                        <button class="settings-tab" data-content="settings-tutorial" id="tab-tutorial">
                            <i class="fas fa-graduation-cap"></i> Tutorial
                        </button>
                    </div>
                </header>

                <div class="modal-content-wrapper">

                    <div class="settings-tab-content active" id="settings-general">
                        <div class="settings-content">
                            <div class="property-group">
                                <label class="setting-label">
                                    <input type="checkbox" id="setting-grid" checked>
                                </label>
                            </div>
                            <div class="property-group">
                                <label class="setting-label">
                                    <input type="checkbox" id="setting-tooltips" checked>
                                    <span class="checkmark"></span> Show Tooltips
                                </label>
                            </div>
                            <div class="property-group">
                                <label class="setting-label">
                                    <input type="checkbox" id="setting-helpers" checked>
                                    <span class="checkmark"></span> Show Helpers
                                </label>
                            </div>
                            <div class="property-group">
                                <label class="setting-label">
                                    <input type="checkbox" id="setting-darkmode" checked>
                                    <span class="checkmark"></span> Dark Mode
                                </label>
                            </div>
                            <div class="property-group">
                                <label class="setting-label">
                                    <input type="checkbox" id="setting-autosave" checked>
                                    <span class="checkmark"></span> Auto Save
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="settings-tab-content" id="settings-scene">
                        <div class="scene-settings-content">
                            <div class="property-group">
                                <label class="property-label">
                                    Canvas Size:
                                </label>
                                <div style="display:flex; gap:5px; margin-top:8px; margin-bottom:15px;">
                                    <input type="number" id="setting-width" value="32" min="4" max="128"
                                        style="flex:1; padding:4px; font-family:monospace; text-align:center;">
                                    <input type="number" id="setting-height" value="32" min="4" max="128"
                                        style="flex:1; padding:4px; font-family:monospace; text-align:center;">
                                </div>
                                <button id="apply-canvas-size" class="btn" style="width:100%; margin-bottom:15px;">Apply
                                    Resize</button>
                            </div>

                            <div class="property-group">
                                <label class="setting-label">
                                    <input type="checkbox" id="setting-show-minimap" checked>
                                    <span class="checkmark"></span> Show Minimap
                                </label>
                            </div>
                            <div class="property-group">
                                <label class="setting-label">
                                    <input type="checkbox" id="setting-snap-to-grid">
                                    <span class="checkmark"></span> Snap to Grid
                                </label>
                            </div>
                            <div class="property-group">
                                <label class="setting-label">
                                    <input type="checkbox" id="setting-show-coords" checked>
                                    <span class="checkmark"></span> Show Coordinates
                                </label>
                            </div>

                            <div class="property-group">
                                <label class="property-label">
                                    <input type="checkbox" id="setting-background-enabled" checked>
                                    Enable Custom Background
                                </label>
                            </div>
                            <div class="property-group">
                                <label class="property-label">
                                    Background Color:
                                    <input type="color" id="setting-background-color" value="#1a1a2e">
                                </label>
                            </div>
                            <div class="property-group">
                                <label class="setting-label">
                                    <input type="checkbox" id="setting-ambient-light" checked>
                                    <span class="checkmark"></span> Enable Ambient Light
                                </label>
                            </div>
                            <div class="property-group">
                                <label class="property-label">
                                    Ambient Light Color:
                                    <input type="color" id="setting-ambient-color" value="#ffffff">
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="settings-tab-content" id="settings-export">
                        <div class="export-settings-content">
                            <div class="property-group">
                                <label class="setting-label">
                                    <input type="checkbox" id="setting-export-transparent" checked>
                                    <span class="checkmark"></span> Export with Transparent Background
                                </label>
                            </div>
                            <div class="property-group">
                                <label class="property-label">
                                    Export Resolution:
                                    <select id="setting-export-resolution"
                                        style="background: var(--bg-light); border: 1px solid var(--border-color); border-radius: 4px; padding: 6px 10px; font-size: 0.8rem; color: var(--text-primary); width: 100%; margin-top: 6px;">
                                        <option value="24x24">24×24 - Game Icon</option>
                                        <option value="36x36">36×36 - Game Icon</option>
                                        <option value="48x48">48×48 - Game Icon</option>
                                        <option value="128x128">128×128 - Game Sprite</option>
                                        <option value="512x512">512×512 - Game Texture</option>
                                        <option value="1024x1024">1024×1024 - High-res Texture</option>

                                        <option value="1920x1080">1920×1080 - Full HD</option>
                                        <option value="2560x1440">2560×1440 - 2K</option>
                                        <option value="3840x2160">3840×2160 - 4K</option>
                                        <option value="custom">Custom Size</option>
                                    </select>
                                </label>
                            </div>
                            <div class="property-group" id="custom-resolution-group" style="display: none;">
                                <label class="property-label">
                                    Custom Width:
                                    <input type="number" id="setting-custom-width" value="1920" min="100" max="8000">
                                </label>
                                <label class="property-label">
                                    Custom Height:
                                    <input type="number" id="setting-custom-height" value="1080" min="100" max="8000">
                                </label>
                            </div>
                            <div class="property-group"
                                style="margin-top: 16px; padding-top: 12px; border-top: 1px solid var(--border-color);">
                                <button id="exportSettingsBtn" class="btn" style="margin-bottom: 8px; width: 100%;">
                                    <i class="fas fa-cloud-download-alt"></i> Export Defaults
                                </button>
                                <button id="saveToBrowserBtn" class="btn" style="margin-bottom: 8px; width: 100%;">
                                    <i class="fas fa-save"></i> Save to Browser
                                </button>
                                <button id="loadFromBrowserBtn" class="btn secondary" style="width: 100%;">
                                    <i class="fas fa-download"></i> Load from Browser
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="settings-tab-content" id="settings-tutorial">
                        <div class="settings-content">
                            <div class="property-group">
                                <label class="property-label">
                                    Tutorial Settings
                                </label>
                            </div>

                            <div class="property-group">
                                <label class="setting-label">
                                    <input type="checkbox" id="enableTutorialsSettings" checked>
                                    <span class="checkmark"></span> Enable Tutorials
                                </label>
                                <div
                                    style="font-size: 11px; color: var(--text-secondary); margin-top: 4px; margin-left: 30px;">
                                    Show interactive tutorials on startup
                                </div>
                            </div>

                            <div class="property-group">
                                <label class="setting-label">
                                    <input type="checkbox" id="showTutorialHints" checked>
                                    <span class="checkmark"></span> Show Tutorial Hints
                                </label>
                                <div
                                    style="font-size: 11px; color: var(--text-secondary); margin-top: 4px; margin-left: 30px;">
                                    Display helpful hints and tooltips
                                </div>
                            </div>

                            <div class="property-group"
                                style="margin-top: 16px; padding-top: 12px; border-top: 1px solid var(--border-color);">
                                <button id="startTutorialBtn" class="btn" style="margin-bottom: 8px; width: 100%;">
                                    <i class="fas fa-graduation-cap"></i> Start Tutorial
                                </button>
                                <button id="resetTutorialBtn" class="btn secondary" style="width: 100%;">
                                    <i class="fas fa-redo"></i> Reset Tutorial Progress
                                </button>
                            </div>
                        </div>
                    </div>

                </div>
                <footer>
                    <div class="modal-actions">
                        <button class="btn" id="btn-settings-reset">Reset</button>
                        <button class="btn" id="btn-settings-close">Close</button>
                        <button class="btn primary" id="btn-settings-save">Save Settings</button>
                    </div>
                </footer>
            </div>
        </div>



        <!-- Hidden Inputs -->
        <input type="file" id="fileInput" accept=".json" style="display: none;">
        <input type="file" id="paletteFileInput" accept=".ase" style="display: none;">

        <!-- Scripts -->
        <script src="js/lena.js"></script>
        <script src="js/config.js"></script>
        <script src="js/state.js"></script>
        <script src="js/dom.js"></script>

        <!-- Add tooltip.js for enhanced tooltip support -->
        <script src="js/tooltip.js"></script>

        <script src="js/right-panel-manager.js"></script>
        <script src="js/tool-manager.js"></script>
        <script src="js/canvas-manager.js"></script>
        <script src="js/layer-manager.js"></script>
        <script src="js/animation-manager.js"></script>
        <script src="js/color-manager.js"></script>
        <script src="js/filter-manager.js"></script>
        <script src="js/file-manager.js"></script>
        <script src="js/ui-manager.js"></script>
        <script src="js/input-handler.js"></script>
        <script src="js/dither-manager.js"></script>
        <script src="js/tilemap-manager.js"></script>
        <script src="js/tutorialConfig.js"></script>
        <script src="js/tutorialSystem.js"></script>
        <script src="js/settings-manager.js"></script>
        <script src="js/notifications.js"></script>
        <script src="js/app.js"></script>
        <script>
            // Add mouseover and mouseout event listeners for the tool buttons
            document.addEventListener('DOMContentLoaded', function() {
                const toolButtons = document.querySelectorAll('.tool-btn[data-title]');
                const titleDiv = document.getElementById('title');
                
                toolButtons.forEach(button => {
                    button.addEventListener('mouseover', function() {
                        const title = this.getAttribute('data-title');
                        if (title && titleDiv) {
                            titleDiv.textContent = title;
                        }
                    });
                    
                    button.addEventListener('mouseout', function() {
                        if (titleDiv) {
                            titleDiv.textContent = '';
                        }
                    });
                });
                
                // Add highlight functionality for buttons in the move-options section
                const moveOptionsButtons = document.querySelectorAll('#move-options .tool-btn');
                moveOptionsButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        moveOptionsButtons.forEach(btn => btn.classList.remove('selected'));
                        this.classList.add('selected');
                    });
                });
            });
        </script>
        
</body>


</html>