<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pixel Art Studio Pro</title>
    <link rel="icon" type="image/png" href="/pixelArt/favicon-96x96.png" sizes="96x96" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="css/styles.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Inter:wght@400;500;600;700&display=swap');
    </style>
</head>

<body>

    <!-- HEADER -->
    <header>
        <div class="logo-area">
            <h1>PixelPro</h1>
            <span class="badge">V3.1</span>
        </div>
        <div class="header-controls">
            <button id="undoBtn" class="btn icon-only" title="Undo (Ctrl+Z)"><i class="fas fa-undo"></i></button>
            <button id="redoBtn" class="btn icon-only" title="Redo (Ctrl+Y)"><i class="fas fa-redo"></i></button>
            <div class="separator" style="height: 20px; width: 1px; margin: 0 10px;"></div>
            <button id="loadProjectBtn" class="btn"><i class="fas fa-folder-open"></i> Load</button>
            <button id="saveProjectBtn" class="btn primary"><i class="fas fa-save"></i> Save</button>
            <button id="downloadSheetBtn" class="btn"><i class="fas fa-file-export"></i> Export</button>
        </div>
    </header>

    <!-- MAIN CONTAINER -->
    <div class="main-container">

        <!-- LEFT TOOLBAR -->
        <aside class="toolbar" id="tool-buttons">
            <button class="tool-btn active" data-tool="pencil" title="Pencil (P)"><i
                    class="fas fa-pencil-alt"></i></button>
            <button class="tool-btn" data-tool="brush" title="Brush (B)"><i class="fas fa-paint-brush"></i></button>
            <button class="tool-btn" data-tool="eraser" title="Eraser (E)"><i class="fas fa-eraser"></i></button>
            <div class="separator"></div>
            <button class="tool-btn" data-tool="bucket" title="Fill Bucket (F)"><i class="fas fa-fill-drip"></i></button>
            <button class="tool-btn" data-tool="mirror" title="Mirror (X)"><i class="fas fa-columns"></i></button>
            <button class="tool-btn" data-tool="dither" title="Dither (D)"><i class="fas fa-th"></i></button>
            <button class="tool-btn" data-tool="eyedropper" title="Color Picker (I)"><i
                    class="fas fa-eye-dropper"></i></button>
            <button class="tool-btn" data-tool="move" title="Move (M)"><i class="fas fa-arrows-alt"></i></button>
            <div class="separator"></div>
            <button class="tool-btn" data-tool="stroke" title="Line (L)"><i class="fas fa-slash"></i></button>
            <button class="tool-btn" data-tool="rect" title="Rectangle (R)"><i class="far fa-square"></i></button>
            <button class="tool-btn" data-tool="circle" title="Circle (C)"><i class="far fa-circle"></i></button>
            <div class="toolbar-spacer"></div>
            <button class="tool-btn" id="layersBtn" title="Layers (L)"><i class="fas fa-layer-group"></i></button>
            <button class="tool-btn" id="settingsBtn" title="Settings (S)"><i class="fas fa-cog"></i></button>
        </aside>

        <!-- CENTER WORKSPACE -->
        <div class="workspace">

            <!-- CANVAS AREA -->
            <div id="canvas-wrapper">
                <div id="drawing-area">
                    <canvas id="layer-composition"></canvas>
                    <canvas id="previewLayer"></canvas>
                    <canvas id="grid-overlay"></canvas>
                </div>
                <!-- Zoom Info Overlay -->
                <div class="zoom-overlay">
                    <span id="coords">0, 0</span> | <span id="zoomDisplay">100%</span>
                </div>
            </div>

            <!-- TIMELINE PANEL -->
            <div class="timeline-panel">
                <div class="timeline-controls">
                    <div style="display:flex; gap:5px;">
                        <button id="playBtn" class="btn icon-only"><i class="fas fa-play"></i></button>
                        <button id="stopBtn" class="btn icon-only"><i class="fas fa-stop"></i></button>
                        <div style="width:10px"></div>
                        <label
                            style="font-size:10px; color:var(--text-secondary); display:flex; align-items:center; gap:5px;">
                            FPS: <span id="fpsDisplay">12</span>
                            <input type="range" id="fpsSlider" min="1" max="60" value="12" style="width:80px">
                        </label>
                    </div>
                    <div style="display:flex; gap:5px;">
                        <button id="addFrameBtn" class="btn icon-only" title="Add Frame"><i
                                class="fas fa-plus"></i></button>
                        <button id="duplicateFrameBtn" class="btn icon-only" title="Duplicate"><i
                                class="fas fa-copy"></i></button>
                        <button id="deleteFrameBtn" class="btn icon-only" title="Delete"><i
                                class="fas fa-trash"></i></button>
                    </div>
                </div>
                <div id="frames-list" class="timeline-frames">
                    <!-- Frames injected here -->
                </div>
            </div>

        </div>

        <!-- RIGHT PANEL (SLIDE OUT) -->
  <aside class="right-panel" id="side-panel">
    
    <div id="panel-preview" class="panel-section">
        <div class="section-title"><span>Preview</span></div>
        <div id="preview-container"
            style="width:120px; height:120px; background:#e0e0e0; display:flex; align-items:center; justify-content:center; border:1px solid var(--border-color); margin:0 auto; position:relative;">
            <canvas id="previewCanvas" style="width:100%; height:100%; image-rendering: pixelated;"></canvas>
            <div id="minimap-overlay" style="position:absolute; pointer-events:none; border:1px solid var(--accent-primary); background:rgba(0,255,65,0.2); display:none;"></div>
        </div>
    </div>

    <div id="panel-palette" class="panel-section">
        <div class="section-title">
            <span>Palette</span>
            <div>
                <button id="saveColorBtn" title="Save Color"
                    style="background:none; border:none; color:var(--accent-primary); cursor:pointer;"><i
                        class="fas fa-plus"></i></button>
                <button id="importPaletteUrlBtn" title="Import Palette"
                    style="background:none; border:none; color:var(--text-secondary); cursor:pointer;"><i
                        class="fas fa-cloud-download-alt"></i></button>
            </div>
        </div>
        <div style="display:flex; gap:10px; margin-bottom:10px; align-items:center;">
            <input type="color" id="colorPicker" value="#00ff41"
                style="width:30px; height:30px; padding:0; border:none; background:none;">
            <input type="text" id="colorHex" value="#00ff41"
                style="background:transparent; border:1px solid var(--border-color); color:var(--text-primary); width:70px; padding:4px; font-family:monospace;">
        </div>
        <div id="palette-container" class="palette-grid">
        </div>
    </div>

    <div id="panel-tool-options" class="panel-section">
        <div class="section-title"><span>Tools Options</span></div>
        <div style="margin-bottom:10px;">
            <label style="font-size:11px; display:block; color:var(--text-secondary); margin-bottom:4px;">Brush
                Size <span id="brushSizeDisplay">1</span>px</label>
            <input type="range" id="brushSizeSlider" min="1" max="20" value="1" style="width:100%;">
            <div style="display:flex; gap:3px; margin-top:5px; flex-wrap:wrap;">
                <button class="preset-brush-size" data-size="1" style="background:var(--bg-light); border:1px solid var(--border-color); color:var(--text-primary); padding:2px 6px; border-radius:3px; cursor:pointer; font-size:10px; min-width:24px;">1</button>
                <button class="preset-brush-size" data-size="2" style="background:var(--bg-light); border:1px solid var(--border-color); color:var(--text-primary); padding:2px 6px; border-radius:3px; cursor:pointer; font-size:10px; min-width:24px;">2</button>
                <button class="preset-brush-size" data-size="3" style="background:var(--bg-light); border:1px solid var(--border-color); color:var(--text-primary); padding:2px 6px; border-radius:3px; cursor:pointer; font-size:10px; min-width:24px;">3</button>
                <button class="preset-brush-size" data-size="4" style="background:var(--bg-light); border:1px solid var(--border-color); color:var(--text-primary); padding:2px 6px; border-radius:3px; cursor:pointer; font-size:10px; min-width:24px;">4</button>
                <button class="preset-brush-size" data-size="5" style="background:var(--bg-light); border:1px solid var(--border-color); color:var(--text-primary); padding:2px 6px; border-radius:3px; cursor:pointer; font-size:10px; min-width:24px;">5</button>
            </div>
        </div>
        <div>
            <label
                style="font-size:11px; display:block; color:var(--text-secondary); margin-bottom:4px;">Opacity
                <span id="opacityDisplay">100</span>%</label>
            <input type="range" id="opacitySlider" min="0" max="100" value="100" style="width:100%;">
        </div>
        
        <div style="margin-top:15px; border-top: 1px solid var(--border-color); padding-top: 10px;">
            <div class="section-title"><span>Zoom</span></div>
            <div style="display:flex; gap:5px; margin-top:8px;">
                <button id="zoomInBtn" class="btn icon-only" title="Zoom In"><i class="fas fa-search-plus"></i></button>
                <button id="zoomOutBtn" class="btn icon-only" title="Zoom Out"><i class="fas fa-search-minus"></i></button>
                <button id="zoomResetBtn" class="btn icon-only" title="Reset Zoom">100%</button>
            </div>
        </div>
    </div>

    <div id="panel-layers" class="panel-section hidden">
        <div class="section-title">
            <span>Layers</span>
            <button id="addLayerBtn"
                style="background:none; border:none; color:var(--accent-primary); cursor:pointer;"><i
                    class="fas fa-plus-circle"></i></button>
        </div>
        <div id="layers-list" class="layers-list" style="max-height: 400px;">
            </div>
    </div>

    <div id="panel-settings" class="panel-section hidden">
        <div class="section-title"><span>Canvas Size</span></div>
        <div style="display:flex; gap:5px; margin-top:8px; margin-bottom:15px;">
            <input type="number" id="widthInput" value="32" min="4" max="128" 
                   style="flex:1; padding:4px; font-family:monospace; text-align:center;">
            <input type="number" id="heightInput" value="32" min="4" max="128" 
                   style="flex:1; padding:4px; font-family:monospace; text-align:center;">
        </div>
        <button id="apply-settings" class="btn " style="width:100%; margin-bottom:15px;">Apply Resize</button>

        <div class="section-title"><span>App Settings</span></div>
        <div class="settings-content">
            <div class="setting-item">
                <label class="setting-label">
                    <input type="checkbox" id="showGrid" checked>
                    <span class="checkmark"></span> Show Grid
                </label>
            </div>
            <div class="setting-item">
                <label class="setting-label">
                    <input type="checkbox" id="snapToGrid">
                    <span class="checkmark"></span> Snap to Grid
                </label>
            </div>
            <div class="setting-item">
                <label class="setting-label">
                    <input type="checkbox" id="showMinimap" checked>
                    <span class="checkmark"></span> Minimap
                </label>
            </div>
            <div class="setting-item">
                <label class="setting-label">
                    <input type="checkbox" id="showCoords" checked>
                    <span class="checkmark"></span> Coordinates
                </label>
            </div>
             <div class="setting-item">
                <label class="setting-label">
                    <input type="checkbox" id="darkMode">
                    <span class="checkmark"></span> Dark Mode
                </label>
            </div>
             <div class="setting-item">
                <label class="setting-label">
                    <input type="checkbox" id="autoSave">
                    <span class="checkmark"></span> Auto Save
                </label>
            </div>
        </div>
        
        <div class="setting-separator"></div>
        <button id="resetSettingsBtn" class="btn" style="width:100%; margin-bottom:8px;">
            <i class="fas fa-undo"></i> Reset Defaults
        </button>
    
        <div class="setting-separator"></div>
        <button id="exportSettingsBtn" class="btn" style="width:100%; margin-bottom:8px;">
            <i class="fas fa-cloud-download-alt"></i> Export Defaults
        </button>
    </div>

</aside>

        <!-- Floating Toggle -->
        <div id="panel-toggle" title="Toggle Panel">
            <i class="fas fa-chevron-right"></i>
        </div>

    </div>

    <!-- Hidden Inputs -->
    <input type="file" id="fileInput" accept=".json" style="display: none;">
    <input type="file" id="paletteFileInput" accept=".ase" style="display: none;">

    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/state.js"></script>
    <script src="js/dom.js"></script>

    <script src="js/tool-manager.js"></script>
    <script src="js/canvas-manager.js"></script>
    <script src="js/layer-manager.js"></script>
    <script src="js/animation-manager.js"></script>
    <script src="js/color-manager.js"></script>
    <script src="js/file-manager.js"></script>
    <script src="js/ui-manager.js"></script>
    <script src="js/input-handler.js"></script>
    <script src="js/app.js"></script>
</body>

</html>